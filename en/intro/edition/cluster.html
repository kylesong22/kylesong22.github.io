<!DOCTYPE html>
<html lang="en" class="no-js">
  <!-- Copyright 2019-2021 Vanessa Sochat-->
  <head>
    <meta charset="utf-8">
    <!-- Copyright 2019-2021 Vanessa Sochat-->
    
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="generator" content="Hugo 0.55.6" />
    
    <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
    
    <link rel="alternate" type="application/rss&#43;xml" href="/docs/index.xml">
    
    <link rel="shortcut icon" href="/en/assets/favicons/favicon.ico" >
    <!-- <link rel="apple-touch-icon" href="/en/assets/favicons/apple-touch-icon-180x180.png" sizes="180x180">
    <link rel="icon" type="image/png" href="/en/assets/favicons/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/en/assets/favicons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-36x36.png" sizes="36x36">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-48x48.png" sizes="48x48">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-72x72.png" sizes="72x72">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-96x196.png" sizes="96x196">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-144x144.png" sizes="144x144">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-192x192.png"sizes="192x192"> -->
    
    <title>Cluster Edition</title>
    <meta property="og:title" content="Cluster Edition" />
    <meta property="og:description" content="machbase-manual documents.
" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="" />
    <meta property="og:site_name" content="" />
    
    <meta itemprop="name" content="Cluster Edition">
    <meta itemprop="description" content="machbase-manual documents.
">
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Cluster Edition"/>
    <meta name="twitter:description" content="machbase-manual documents.
"/>
    
    <link rel="stylesheet" href="/en/assets/css/main.css">
    <link rel="stylesheet" href="/en/assets/css/palette.css">
    <script
      src="/en/assets/js/jquery-3.3.1/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8= sha256-T+aPohYXbm0fRYDpJLr+zJ9RmYTswGsahAoIsNiMld4="
      crossorigin="anonymous"></script>
    </head>
  

  
  <body class="td-section">
    <header>
    <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
    <a class="navbar-brand" href="/en/">
        <span class="navbar-logo"></span><span class="text-uppercase font-weight-bold"><img src="/en/assets/img/logo.png" alt="Machbase manual"></span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
        <li class="nav-item mr-4 mb-2 mb-lg-0">
                        <!-- <a class="nav-link" href="https://github.com/machbase/dbms-manual" target="_blank"><span>GitHub</span></a> -->
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
                        <!-- <a class="nav-link" href="/en/about" ><span>About</span></a> -->
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
                        <!-- <a class="nav-link" href="/en/docs" ><span>Documentation</span></a> -->
        </li>
  <!--  -->
  <!-- <li class="nav-item mr-4 mb-2 mb-lg-0"> -->
    <!-- 
      <span class="nav-link ">Release:</span>
    
    <li class="nav-item dropdown d-none d-lg-block">
      <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Current</a>
      <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
        
        
          
            <a class="dropdown-item" href="/en/intro/edition/cluster.html">Current</a>
          
        
        
          
            
            <a class="dropdown-item" href="/en/intro/edition/cluster.html">Previous</a>
          
         -->
      </div>
    </li>
  <!-- </li> -->
  
    </ul>
</div>
<div class="navbar-nav d-none d-lg-block">
<input type="search" class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete="on">
    </div>

<!-- <div class="navbar-nav d-none d-lg-block">
      <a class="gh-source" data-gh-source="github" href="https://github.com/machbase/dbms-manual" title="Go to repository" data-md-state="done">
      <div class="gh-source__repository">
        <i class="fab fa fa-github fa-2x" style='padding-right:20px; float:left; margin-top:5px'></i>
        machbase/dbms-manual
      <ul class="gh-source__facts"><li class="gh-source__fact" id='stars'></li><li id="forks" class="gh-source__fact"></li></ul></div></a>
    </div> -->
  </div>


</nav>
</header>

<script>
$(document).ready(function() {
var url = "https://api.github.com/search/repositories?q=machbase/dbms-manual";
fetch(url, { 
  headers: {"Accept":"application/vnd.github.preview"}
}).then(function(e) {
return e.json()
}).then(function(r) {
 console.log(r.items[0])
 stars = r.items[0]['stargazers_count']
 forks = r.items[0]['forks_count']
 $('#stars').text(stars + " Stars")
 $('#forks').text(forks + " Forks")
});
});
</script>

    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          <div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    <input type="search" class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete="off">
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation"></button>
  </form>  
  
  <nav class="collapse td-sidebar-nav pt-2 pl-4" id="td-section-nav">
    
      <ul class="td-sidebar-nav__section pr-md-3">
        
        
      
        <li class="td-sidebar-nav__section-title">
          <a href="" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Machbase Manual</a>
        </li>
        
        
          <ul>
            <li class="collapse show" id="machbase-manual">
              <ul class="td-sidebar-nav__section pr-md-3">
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">Introduction</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="introduction">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-introduction-introduction-of-machbase" href="/en//intro/introduction">Introduction of Machbase</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-introduction-machbase-features" href="/en//intro/features">Machbase Features</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-introduction-introduction-of-machbase-products" href="/en//intro/products">Introduction of Machbase Products</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">Installation</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="installation">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-package-overview" href="/en//install/package">Package Overview</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-linux-installation" href="/en//install/linux">Linux Installation</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-windows-installation" href="/en//install/windows">Windows Installation</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-license-installation" href="/en//install/license">License Installation</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-cluster-edition-installation" href="/en//install/cluster">Cluster Edition Installation</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-upgrade" href="">Upgrade</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">Feature and Tables</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="feature-and-tables">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-tag-table" href="/en//feature-tables/tag">Tag Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-log-table" href="/en//feature-tables/log">Log Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-volatile-table" href="/en//feature-tables/volatile">Volatile Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-lookup-table" href="/en//feature-tables/lookup">Lookup Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-stream" href="/en//feature-tables/stream">STREAM</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-backup-and-mount" href="/en//feature-tables/backup-mount">Backup and Mount</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">Config/Monitoring</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="config-monitoring">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-config-monitoring-meta-table" href="/en//config-monitor/metatable">Meta Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-config-monitoring-virtual-table" href="/en//config-monitor/virtualtable">Virtual Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-config-monitoring-property" href="/en//config-monitor/property">Property</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-config-monitoring-property-cluster" href="/en//config-monitor/property-cluster">Property(Cluster)</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">SQL Reference</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="sql-reference">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-datatypes" href="/en//sql-ref/datatypes">Datatypes</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-ddl" href="/en//sql-ref/ddl">DDL</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-dml" href="/en//sql-ref/dml">DML</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-select" href="/en//sql-ref/select">SELECT</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-select-hint" href="/en//sql-ref/select-hint">SELECT Hint</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-user-management" href="/en//sql-ref/user-manage">User Management</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-functions" href="/en//sql-ref/func">Functions</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-system-session-management" href="/en//sql-ref/sys-session-manage">System/Session Management</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">SDK</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="sdk">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-cli-odbc" href="/en//sdk/cli-odbc">CLI/ODBC</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-cli-odbc-example" href="/en//sdk/cli-odbc-example">CLI/ODBC Example</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-jdbc" href="/en//sdk/jdbc">JDBC</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-python" href="/en//sdk/python">Python</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-net-connector" href="/en//sdk/dotnet">.Net Connector</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-restfull-api" href="/en//sdk/restful">RESTfull API</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-timezone" href="/en//sdk/timezone">Timezone</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">Tools</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="tools">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-tools-utilities" href="/en//tools/utils">Utilities</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-tools-machcoordinatoradmin" href="/en//tools/machcoordinatoradmin">machcoordinatoradmin</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-tools-machdeployeradmin" href="/en//tools/machdeployeradmin">machdeployeradmin</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">FAQ</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="faq">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-faq-how-to-fix-properties-when-an-insufficient-memory-error-occurs" href="/en//faq/memory-error">How to fix properties when an insufficient memory error occurs</a>
                        
                      </li>
                    </ul>
                  
                  
                
              </ul>
            </li>
          </ul>
        
        
      </ul>
    
  </nav>
</div>

          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
              <div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
              </div>
              <nav id="TableOfContents"><ul>
              <li><ul id="TOC">
                <!-- Links will be appended here-->
              </ul></li>
              </ul></nav>
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	      <ol class="breadcrumb spb-1">
              
              
                
                  
                    
                      
                      <li class="breadcrumb-item">
                        <a href="/en/intro/">Intro</a>
                      </li>
                      
                    
                  
                
              
                
                  
                    
                      
                      <li class="breadcrumb-item">
                        <a href="/en/intro/edition/">Edition</a>
                      </li>
                      
                    
                  
                
              
                
                  
                    <li class="breadcrumb-item active" aria-current="page">
                      <a href="/en/intro/edition/cluster.html">Cluster Edition</a>
                    </li>
                  
                
              
	      </ol>
           </nav>
           <div class="td-content">        
            
              
            
            
	      <!-- Copyright 2019-2021 Vanessa Sochat-->
<h1 style="margin-bottom:0px">Cluster Edition</h1>

<span class="post-date" style="font-style: italic;"></span>
<h1 id="index">Index</h1>

<ul>
  <li><a href="#why-should-we-use-the-cluster-edition">Why Should We Use the Cluster Edition?</a></li>
  <li><a href="#terms">Terms</a></li>
  <li><a href="#structure">Structure</a>
    <ul>
      <li><a href="#classifications-of-node">Classifications of Node</a></li>
      <li><a href="#coordinator">Coordinator</a></li>
      <li><a href="#special-node-deployer">Special Node: Deployer</a></li>
      <li><a href="#warehouse">Warehouse</a></li>
      <li><a href="#node-port-management">Node Port Management</a></li>
    </ul>
  </li>
  <li><a href="#saveselect-data">Save/Select Data</a>
    <ul>
      <li><a href="#save-data">Save Data</a></li>
      <li><a href="#select-data">Select Data</a></li>
    </ul>
  </li>
  <li><a href="#replication">Replication</a>
    <ul>
      <li><a href="#coordinator-replication">Coordinator Replication</a></li>
      <li><a href="#lookup-replication">Lookup Replication</a></li>
      <li><a href="#broker-replication">Broker Replication</a></li>
      <li><a href="#the-broker-is-not-a-replication-target">The Broker is not a Replication target.</a></li>
      <li><a href="#warehouse-replication">Warehouse Replication</a></li>
    </ul>
  </li>
  <li><a href="#how-to-recover">How To Recover</a></li>
  <li><a href="#not-supported-features">Not Supported Features</a>
    <ul>
      <li><a href="#query-statement">Query Statement</a></li>
      <li><a href="#clausefunction">Clause/Function</a></li>
    </ul>
  </li>
  <li><a href="#supported-hardware-and-operating-systems">Supported Hardware and Operating Systems</a></li>
</ul>

<p>The Cluster Edition is a product with high input speed and standard SQL  that can process large data input / inquiries in a distributed environment that not even the Machbase Fog Edition can process, such as on multiple servers either on premise or in the cloud.</p>

<h1 id="why-should-we-use-the-cluster-edition">Why Should We Use the Cluster Edition?</h1>

<p>Machbase offers Fog Edition which inputs time series data at extremely high speed. However, the following disadvantages exist:</p>

<ul>
  <li>Because it consists of a single process, it lacks in high availability (HA).</li>
  <li>Because one process is dedicated to analyzing data, there is a limit to increasing the performance of large data analysis.</li>
</ul>

<p>To overcome these shortcomings, there is a need for a higher end distributed product that can ensure availability and scalability  when storing and analyzing large amounts of data. The Machbase Cluster Edition meets these requirements.</p>

<h1 id="terms">Terms</h1>

<p>Host
Represents one physical server, or one OS instance in the cloud/VM.</p>

<p>Node
Represents the Machbase Process residing on the server.</p>

<p>The Process type is the same as the Node types below.</p>

<ul>
  <li>Coordinator</li>
  <li>Deployer</li>
  <li>Lookup</li>
  <li>Broker</li>
  <li>Warehouse</li>
</ul>

<h1 id="structure">Structure</h1>

<p>In the Machbase Cluster Edition, several nodes that reside in the Host constitute one cluster.</p>

<p><img src="/en/intro/edition/clusteredition.png" alt="clusteredition" /></p>

<p>High Availability
The service can be continued even if one of all the internal nodes is interrupted.</p>

<p>High Scalability
Data storage can be distributed, and parallel analysis is possible from the distributed data, so</p>

<p>performance increases as the cluster grows.</p>

<h2 id="classifications-of-node">Classifications of Node</h2>
<p>Each Node can be classified as follows:</p>

<table>
  <thead>
    <tr>
      <th>Classification</th>
      <th>Description</th>
      <th>Process Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Coordinator</td>
      <td>The process of managing all general purpose servers and nodes</td>
      <td>machcoordinatord</td>
    </tr>
    <tr>
      <td>Deployer</td>
      <td>The process that resides on each host<br /> Responsible for installing, upgrading, and monitoring the Broker / Warehouse.</td>
      <td>machdeployerd</td>
    </tr>
    <tr>
      <td>Lookup</td>
      <td>The process of Lookup table data.</td>
      <td>machlookupd</td>
    </tr>
    <tr>
      <td>Broker</td>
      <td>The process of welcoming an actual client program.<br /> Serves to distribute client data insert / data lookup queries to the warehouse.</td>
      <td>machbased</td>
    </tr>
    <tr>
      <td>Warehouse</td>
      <td>The process that stores the actual data<br /> Stores some of the entire cluster data and executes the commands received from the Broker.</td>
      <td>machbased</td>
    </tr>
  </tbody>
</table>

<h2 id="coordinator">Coordinator</h2>

<p>Coordinator is a process that manages the state of all nodes, and can be a maximum of two.</p>

<p>First, the generated Coordinator is called the Primary Coordinator, and the other is called the Secondary Coordinator, and only the Primary Coordinator manages the state of all the Nodes.</p>

<p>When the Primary Coordinator is down, the Secondary Coordinator is upgraded to Primary Coordinator.</p>

<h2 id="special-node-deployer">Special Node: Deployer</h2>
<p>It is managed by the Coordinator, but it is simply  a process  that installs / removes Broker / Warehouse / Lookup Nodes.</p>

<p>Normally, only one Deployer can be added to the Host at a time when installing Nodes, but multiple Deployers can be added for installation performance.</p>

<p><img src="/en/intro/edition/deployer.png" alt="deployer" /></p>

<p><img src="/en/intro/edition/deployer2.png" alt="deployer2" /></p>

<p>Example of Installation From Server
Figure (a) below shows the installation of two Coordinators, two Brokers, four Warehouse Active, and four Warehouse Standby Nodes on four generic servers.</p>

<p>As shown in the figure,  you can distinguish each node with ‘hostname: port’ followed by the host name of the general-purpose server and the assigned port number.</p>

<p><img src="/en/intro/edition/deploynode.png" alt="deploynode" /></p>

<h2 id="lookup">Lookup</h2>

<p>Lookup is for data management in Lookup Table.</p>

<h2 id="broker">Broker</h2>

<p>The Broker delivers the Client’s commands to the Warehouse, and then collects the results of the Warehouse and transmits them back into the Client.</p>

<ul>
  <li>When entering data, the Broker makes sure the data enters evenly into the Warehouse.</li>
  <li>When retrieving data, the Broker fetches the data to the Warehouse and collects and delivers all the results.</li>
</ul>

<p>The Broker does not have the data in the Log Table, but it has the data in the Volatile Table.</p>

<h2 id="warehouse">Warehouse</h2>

<p>The Warehouse will store the Log Table data directly, and will act as the actual execution of the command delivered by the Broker.</p>

<p>Like the Broker, there is direct client access to the Warehouse, but the data can not be input / updated / deleted; the Warehouse data can only be retrieved.</p>

<p>Warehouse Group</p>

<p>The Warehouse can specify the Group to which it belongs.</p>

<ul>
  <li>When the Broker inputs data, all Warehouses in the same Group receive the same records.</li>
  <li>Even if a specific Warehouse of the group is dropped, there are no issues with data retrieval.</li>
  <li>When a new Warehouse is added to a group, the same records are maintained through Replication.</li>
</ul>

<p>Status of Warehouse Group</p>

<table>
  <thead>
    <tr>
      <th>Status</th>
      <th>INSERT/APPEND</th>
      <th>SELECT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Normal</td>
      <td>O</td>
      <td>O</td>
    </tr>
    <tr>
      <td>Readonly</td>
      <td>X</td>
      <td>O</td>
    </tr>
  </tbody>
</table>

<p>The conditions that change to Readonly state are as follows.</p>

<ul>
  <li>During INSERT / APPEND, if some Warehouses in the Group fail to be input
    <ul>
      <li>Because there is a data inconsistency between the failed Warehouses and the successful Warehouses,
the failed Warehouse is placed in the Scrapped state and the group is moved to the Readonly state to avoid receiving further input. (warning)</li>
    </ul>
  </li>
  <li>When a new Warehouse is added
    <ul>
      <li>If the input is received even while the replication process is in progress, the state is changed to the Readonly state because the end of the replication is unknown. (warning)</li>
    </ul>
  </li>
</ul>

<h2 id="node-port-management">Node Port Management</h2>
<p>Each Node must have several ports open, which are distinguished as follows:</p>

<p><img src="/en/intro/edition/node_port.png" alt="nodeport" /></p>

<table>
  <thead>
    <tr>
      <th>Port Classification</th>
      <th>Description</th>
      <th>Required Node</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Service Port</td>
      <td>Port directly connected by client</td>
      <td>Broker / Warehouse</td>
    </tr>
    <tr>
      <td>Cluster Port</td>
      <td>Port for communication between Nodes</td>
      <td>All Nodes</td>
    </tr>
    <tr>
      <td>Replication Port</td>
      <td>Port for communication between warehouses for replication</td>
      <td>Warehouse</td>
    </tr>
    <tr>
      <td>Admin Port</td>
      <td>Port for communication for management purpose</td>
      <td>Coordinator / Deployer</td>
    </tr>
  </tbody>
</table>

<p>Commands That Can Be Executed After Direct Connection</p>

<p>The following table lists the possible and not possible commands to connect directly to each Node. 
All nodes are accessible via the client, but there are queries that are not possible depending on the type of Node.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>Broker (Leader)</th>
      <th>Broker (non-leader)</th>
      <th>Warehouse Standby</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Client Connection</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
    </tr>
    <tr>
      <td>DDL</td>
      <td>O</td>
      <td>X</td>
      <td>X</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>O</td>
      <td>O</td>
      <td>X</td>
    </tr>
    <tr>
      <td>INSERT</td>
      <td>O</td>
      <td>O</td>
      <td>X</td>
    </tr>
    <tr>
      <td>APPEND</td>
      <td>O</td>
      <td>O</td>
      <td>X</td>
    </tr>
    <tr>
      <td>SELECT</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
    </tr>
  </tbody>
</table>

<h1 id="saveselect-data">Save/Select Data</h1>

<p>Machbase Cluster Edition can distribute the data and collect the results computed by distributed query execution. This section explains how to store and lookup the table type.</p>

<h2 id="save-data">Save Data</h2>

<h3 id="log-table">Log Table</h3>

<p>When data is entered into the Log Table through the Broker, it is distributed to all warehouses. (The data is not stored in the Broker that performs the input.) The Coordinator determines the database size of each warehouse, and the Broker distributes the data based on that.</p>

<p>If data is entered directly into the Log Table via the Warehouse, it is stored only in the corresponding Warehouse. Can be selected to avoid performance degradation due to distributed algorithm and network bottleneck.</p>

<h3 id="volatile-table">Volatile Table</h3>

<p>When a Broker enters data into a Volatile Table, it is stored in the corresponding Broker. In other words, no data is entered or synchronized with other Brokers.</p>

<p>The reason for not supporting replication for Volatile Tables is that if it matches the characteristics of the Volatile Table able to DELETE, it affects the replication performance.</p>

<p>Volatile tables are created only in the Broker, so they can not be entered in the Warehouse.</p>

<h3 id="lookup-table">Lookup Table</h3>

<p>When data is entered into the lookup table through a broker, the entered data is stored in the lookup node and replicated to other brokers through replication.</p>

<h3 id="tag-table">Tag Table</h3>

<p>It is the same as the storage method of the log table. However, when entering data including a new TagID, it can only be entered through the Leader Broker.</p>

<h2 id="select-data">Select Data</h2>

<h3 id="log-table-1">Log Table</h3>

<p>When you view the data in the Log Table through the Broker, queries are distributed to all Warehouses. Each Warehouse actually performs the query, exchanging intermediate results between the Warehouses if necessary. The Broker collects the partial results generated in this way and returns the final result.</p>

<p>When viewing the data in the Log Table through the Warehouse, the query is executed only in the corresponding warehouse. This process is identical to query execution in the Fog Edition.</p>

<h3 id="lookup--volatile-table">Lookup / Volatile Table</h3>

<p>When viewing data in a Volatile Table through a Broker, the query is executed only by the Broker. This process is identical to query execution in the Fog Edition.</p>

<p>JOIN can not be done through the Warehouse, because Volatile Tables are not created.</p>

<h3 id="join-between-two-tables">JOIN Between Two Tables</h3>

<p>When joining a Log Table and a Volatile Table through a Broker, the connected Broker and the rest of the Warehouse execute the query at the same time. The Broker distributes the results of the Volatile table to the Warehouse.</p>

<p>The Warehouse JOINs the data delivered by the broker and returns the result. The Broker collects the partial results generated in this way and returns the final result.</p>

<p>JOIN can not be done through the warehouse, because volatile tables are not created.</p>

<h1 id="replication">Replication</h1>

<p>Replication refers to the process of replicating the same node in preparation for failure of an existing node.</p>

<h2 id="coordinator-replication">Coordinator Replication</h2>

<p>Up to two Coordinators can be created in Cluster Edition.</p>

<p>Both Coordinators continuously maintain Cluster Node information.</p>

<p>Even if either end abnormally, the remaining Coordinator can continue managing the Cluster Node.</p>

<p><strong>When the Primary Coordinator is restarted, the existing secondary coordinator is upgraded to primary and the restarting coordinator becomes secondary.</strong></p>

<h2 id="lookup-replication">Lookup Replication</h2>

<p>Basically, the Lookup Master manages the Lookup Table data, but you can add a Lookup Slave to duplicate the data.</p>

<h2 id="broker-replication">Broker Replication</h2>

<h3 id="the-broker-is-not-a-replication-target">The Broker is not a Replication target.</h3>

<p>Therefore, the data record of the Volatile Table in Broker A is not kept the same in Broker B. (not synchronized)</p>

<p>However, because the table / index scheme of the entire Cluster are all the same, if the Volatile Table  VOL_TBL1 exists with Broker A,  Volatile Table  VOL_TBL1 also exists with Broker B.</p>

<h2 id="warehouse-replication">Warehouse Replication</h2>

<p>If a new Warehouse is added to the Group, the Warehouse is replicated through the following process.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. The Coordinator starts DDL replication to the new Warehouse.
2. Group switches to Readonly state.
3. One of the Warehouses in the group starts data replication to the new warehouse.
4. When the data replication is completed, the group is switched to the Normal state. In the case of data insert, the Broker guarantees redundancy by sending the same data to the same Group.
</code></pre></div></div>

<h1 id="how-to-recover">How To Recover</h1>

<p>Even if the Node terminates abnormally, the service can be continued in the following manner.</p>

<p>For more information, refer to the Operations Guide.</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Fail-over Method</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Coordinator</td>
      <td>Even if the Primary Coordinator is abnormally terminated, the Secondary Coordinator becomes the Primary Coordinator and the cluster management can continue.<br />Even if the Coordinator is terminated in the worst case scenario, the entire service (data insert / inquiry) can be continued without the cluster management.<br />(Of course, when the Broker or Warehouse is shut down at this time, you can not manage the cluster.)</td>
    </tr>
    <tr>
      <td>Deployer</td>
      <td>Node operation (ADD, REMOVE ..) can not be performed on the corresponding Host, and statistical information of the host can not be collected.</td>
    </tr>
    <tr>
      <td>Lookup</td>
      <td>When a failure occurs in Lookup Master, Lookup Monitor automatically detects and changes one of the Lookup Slaves to Lookup Master to enable continuous service use.<br />If there is no Lookup Slave in the past, it is recommended that at least one Lookup Slave exists for stable HA because data replication is not possible.</td>
    </tr>
    <tr>
      <td>Broker</td>
      <td>Even if the Broker is terminated, the service can continue if another Broker exists.<br />However, because the connection to the client that has been terminated is disconnected, it must be reconnected to another Broker.</td>
    </tr>
    <tr>
      <td>Warehouse</td>
      <td>If there is another / other Warehouse (s) in the Group, the Warehouse (s) will participate in SELECT and APPEND.</td>
    </tr>
  </tbody>
</table>

<h1 id="not-supported-features">Not Supported Features</h1>

<h2 id="query-statement">Query Statement</h2>

<h3 id="tablespace">TABLESPACE</h3>

<p>Currently, the Cluster Edition does not distinguish between table spaces.</p>

<h3 id="backup--mount">BACKUP / MOUNT</h3>

<p>Currently, the Cluster Edition does not distinguish between databases.</p>

<h3 id="load-in-file">LOAD IN FILE</h3>

<p>The ability to read and distribute CSV files is currently not implemented.</p>

<h3 id="alter-table-forgery-check">ALTER TABLE FORGERY CHECK</h3>

<p>Result File can not be collected in one place as client’s user data is checked for any changes.</p>

<h2 id="clausefunction">Clause/Function</h2>

<h3 id="union-all">UNION ALL</h3>

<p>Execution units are complex and are currently not supported.</p>

<h3 id="group_concat-function">GROUP_CONCAT() function</h3>

<p>The entire contents of the CONCAT for the subgroups collected by each Warehouse can not be processed as a simple accumulation.
(ORDER BY in GROUP CONCAT)</p>

<h3 id="ts_change_count-function">TS_CHANGE_COUNT() function</h3>

<p>The TS_CHANGE_COUNT results for the subgroups collected in each Warehouse can not be processed as simple accumulations.</p>

<p>In addition, TS_CHANGE_COUNT () is significant if the entire result is sorted, but if the results are distributed in the Warehouse, it is meaningless.</p>

<h1 id="supported-hardware-and-operating-systems">Supported Hardware and Operating Systems</h1>

<table>
  <thead>
    <tr>
      <th>CPU</th>
      <th>Intel Core i Series (Nehalem~) or higher recommended</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Memory</td>
      <td>2 GB or more recommended for each Node to be installed</td>
    </tr>
    <tr>
      <td>Operating System</td>
      <td>Linux (Any distribution)</td>
    </tr>
  </tbody>
</table>


<script
  src="/en/assets/js/jquery-3.3.1/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8= sha256-T+aPohYXbm0fRYDpJLr+zJ9RmYTswGsahAoIsNiMld4="
  crossorigin="anonymous"></script>

<script>
$(document).ready(function() {

    var toc = $('#TOC');

    // Select each header
    sections = $('.td-content h1');
        $.each(sections, function(idx, v) {
            section = $(v);
            var div_id = $(section).attr('id');
            var div_text = section.text().split('¶')[0];
            var parent = $("#" + div_id)
            var content = '<li id="link_' + div_id + '" class="md-nav__item"><a class="md-nav__link" href="#' + div_id + '" title="' + div_text +'">' + div_text +'</a></li>';
            $(toc).append(content);

            // Add section code to subnavigation
            var children = $('<nav class="md-nav"><ul class="md-nav__list"></nav></ul>')
            var contenders = $("#" + div_id).nextUntil("h1");
            $.each(contenders, function(idx, contender){
               if($(contender).is('h2') || $(contender).is('h3')) {
                   var contender_id = $(contender).attr('id');
                   var contender_text = $(contender).text().split('¶')[0];
                   var content = '<li class="md-nav__item"><a class="md-nav__link" href="#' + contender_id + '" title="' + contender_text +'">' + contender_text +'</a></li>';
                   children.append(content);
                }
             })
             $("#link_" + div_id).append(children);
        });
    });
</script>

<script>
var headers = ["h1", "h2", "h3", "h4"]
var colors = ["red", "orange", "green", "blue"]

$.each(headers, function(i, header){
    var color = colors[i];
    $(header).each(function () {
        var href=$(this).attr("id");
        $(this).append('<a class="headerlink" style="color:' + color + '" href="#' + href + '" title="Permanent link">¶</a>')
    });
})
</script>



	
              
              <!-- <style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<h5 class="feedback--title">Feedback</h5>
<p class="feedback--question">Was this page helpful?</p>
<button class="feedback--answer feedback--answer-yes">Yes</button>
<button class="feedback--answer feedback--answer-no">No</button>
<p class="feedback--response feedback--response-yes">
  Glad to hear it! Please <a href="https://github.com/machbase/dbms-manual/issues/new">tell us how we can improve</a>.
</p>
<p class="feedback--response feedback--response-no">
  Sorry to hear that. Please <a href="https://github.com/machbase/dbms-manual/issues/new">tell us how we can improve</a>.
</p>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof ga !== 'function') return;
    const args = {
      command: 'send',
      hitType: 'event',
      category: 'Helpful',
      action: 'click',
      label: window.location.pathname,
      value: value
    };
    ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(1);
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script><br/>

 -->
           </div>
          </main>
        </div>
      </div>
      <footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        <ul class="list-inline mb-0">  
          
            <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="" aria-label="Twitter" data-original-title="Twitter">
              <a class="text-white" target="_blank" href="https://twitter.com/machbase">
                <i class="fab fa-twitter"></i>
              </a>
            </li>
          
          
        </ul>
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        <ul class="list-inline mb-0">  
          <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="" aria-label="GitHub" data-original-title="GitHub">
            <a class="text-white" target="_blank" href="https://github.com/machbase/dbms-manual">
              <i class="fab fa-github"></i>
            </a>
          </li>
        </ul>
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">© 2023  All Rights Reserved</small>
        
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script src="/en/assets/js/main.js"></script>

  </body>
</html>