<!DOCTYPE html>
<html lang="en" class="no-js">
  <!-- Copyright 2019-2021 Vanessa Sochat-->
  <head>
    <meta charset="utf-8">
    <!-- Copyright 2019-2021 Vanessa Sochat-->
    
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="generator" content="Hugo 0.55.6" />
    
    <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
    
    <link rel="alternate" type="application/rss&#43;xml" href="/docs/index.xml">
    
    <link rel="shortcut icon" href="/en/assets/favicons/favicon.ico" >
    <!-- <link rel="apple-touch-icon" href="/en/assets/favicons/apple-touch-icon-180x180.png" sizes="180x180">
    <link rel="icon" type="image/png" href="/en/assets/favicons/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/en/assets/favicons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-36x36.png" sizes="36x36">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-48x48.png" sizes="48x48">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-72x72.png" sizes="72x72">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-96x196.png" sizes="96x196">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-144x144.png" sizes="144x144">
    <link rel="icon" type="image/png" href="/en/assets/favicons/android-icon-192x192.png"sizes="192x192"> -->
    
    <title>.NET Connector</title>
    <meta property="og:title" content=".NET Connector" />
    <meta property="og:description" content="machbase-manual documents.
" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="" />
    <meta property="og:site_name" content="" />
    
    <meta itemprop="name" content=".NET Connector">
    <meta itemprop="description" content="machbase-manual documents.
">
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content=".NET Connector"/>
    <meta name="twitter:description" content="machbase-manual documents.
"/>
    
    <link rel="stylesheet" href="/en/assets/css/main.css">
    <link rel="stylesheet" href="/en/assets/css/palette.css">
    <script
      src="/en/assets/js/jquery-3.3.1/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8= sha256-T+aPohYXbm0fRYDpJLr+zJ9RmYTswGsahAoIsNiMld4="
      crossorigin="anonymous"></script>
    </head>
  

  
  <body class="td-section">
    <header>
    <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
    <a class="navbar-brand" href="/en/">
        <span class="navbar-logo"></span><span class="text-uppercase font-weight-bold"><img src="/en/assets/img/logo.png" alt="Machbase manual"></span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
        <li class="nav-item mr-4 mb-2 mb-lg-0">
                        <!-- <a class="nav-link" href="https://github.com/machbase/dbms-manual" target="_blank"><span>GitHub</span></a> -->
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
                        <!-- <a class="nav-link" href="/en/about" ><span>About</span></a> -->
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
                        <!-- <a class="nav-link" href="/en/docs" ><span>Documentation</span></a> -->
        </li>
  <!--  -->
  <!-- <li class="nav-item mr-4 mb-2 mb-lg-0"> -->
    <!-- 
      <span class="nav-link ">Release:</span>
    
    <li class="nav-item dropdown d-none d-lg-block">
      <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Current</a>
      <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
        
        
          
            <a class="dropdown-item" href="/en/sdk/dotnet.html">Current</a>
          
        
        
          
            
            <a class="dropdown-item" href="/en/sdk/dotnet.html">Previous</a>
          
         -->
      </div>
    </li>
  <!-- </li> -->
  
    </ul>
</div>
<div class="navbar-nav d-none d-lg-block">
<input type="search" class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete="on">
    </div>

<!-- <div class="navbar-nav d-none d-lg-block">
      <a class="gh-source" data-gh-source="github" href="https://github.com/machbase/dbms-manual" title="Go to repository" data-md-state="done">
      <div class="gh-source__repository">
        <i class="fab fa fa-github fa-2x" style='padding-right:20px; float:left; margin-top:5px'></i>
        machbase/dbms-manual
      <ul class="gh-source__facts"><li class="gh-source__fact" id='stars'></li><li id="forks" class="gh-source__fact"></li></ul></div></a>
    </div> -->
  </div>


</nav>
</header>

<script>
$(document).ready(function() {
var url = "https://api.github.com/search/repositories?q=machbase/dbms-manual";
fetch(url, { 
  headers: {"Accept":"application/vnd.github.preview"}
}).then(function(e) {
return e.json()
}).then(function(r) {
 console.log(r.items[0])
 stars = r.items[0]['stargazers_count']
 forks = r.items[0]['forks_count']
 $('#stars').text(stars + " Stars")
 $('#forks').text(forks + " Forks")
});
});
</script>

    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          <div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    <input type="search" class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete="off">
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation"></button>
  </form>  
  
  <nav class="collapse td-sidebar-nav pt-2 pl-4" id="td-section-nav">
    
      <ul class="td-sidebar-nav__section pr-md-3">
        
        
      
        <li class="td-sidebar-nav__section-title">
          <a href="" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Machbase Manual</a>
        </li>
        
        
          <ul>
            <li class="collapse show" id="machbase-manual">
              <ul class="td-sidebar-nav__section pr-md-3">
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">Introduction</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="introduction">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-introduction-introduction-of-machbase" href="/en//intro/introduction">Introduction of Machbase</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-introduction-machbase-features" href="/en//intro/features">Machbase Features</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-introduction-introduction-of-machbase-products" href="/en//intro/products">Introduction of Machbase Products</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">Installation</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="installation">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-package-overview" href="/en//install/package">Package Overview</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-linux-installation" href="/en//install/linux">Linux Installation</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-windows-installation" href="/en//install/windows">Windows Installation</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-license-installation" href="/en//install/license">License Installation</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-cluster-edition-installation" href="/en//install/cluster">Cluster Edition Installation</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-installation-upgrade" href="">Upgrade</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">Feature and Tables</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="feature-and-tables">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-tag-table" href="/en//feature-tables/tag">Tag Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-log-table" href="/en//feature-tables/log">Log Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-volatile-table" href="/en//feature-tables/volatile">Volatile Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-lookup-table" href="/en//feature-tables/lookup">Lookup Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-stream" href="/en//feature-tables/stream">STREAM</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-feature-and-tables-backup-and-mount" href="/en//feature-tables/backup-mount">Backup and Mount</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">Config/Monitoring</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="config-monitoring">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-config-monitoring-meta-table" href="/en//config-monitor/metatable">Meta Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-config-monitoring-virtual-table" href="/en//config-monitor/virtualtable">Virtual Table</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-config-monitoring-property" href="/en//config-monitor/property">Property</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-config-monitoring-property-cluster" href="/en//config-monitor/property-cluster">Property(Cluster)</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">SQL Reference</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="sql-reference">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-datatypes" href="/en//sql-ref/datatypes">Datatypes</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-ddl" href="/en//sql-ref/ddl">DDL</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-dml" href="/en//sql-ref/dml">DML</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-select" href="/en//sql-ref/select">SELECT</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-select-hint" href="/en//sql-ref/select-hint">SELECT Hint</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-user-management" href="/en//sql-ref/user-manage">User Management</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-functions" href="/en//sql-ref/func">Functions</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sql-reference-system-session-management" href="/en//sql-ref/sys-session-manage">System/Session Management</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">SDK</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="sdk">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-cli-odbc" href="/en//sdk/cli-odbc">CLI/ODBC</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-cli-odbc-example" href="/en//sdk/cli-odbc-example">CLI/ODBC Example</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-jdbc" href="/en//sdk/jdbc">JDBC</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-python" href="/en//sdk/python">Python</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-net-connector" href="/en//sdk/dotnet">.Net Connector</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-restfull-api" href="/en//sdk/restful">RESTfull API</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-sdk-timezone" href="/en//sdk/timezone">Timezone</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">Tools</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="tools">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-tools-utilities" href="/en//tools/utils">Utilities</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-tools-machcoordinatoradmin" href="/en//tools/machcoordinatoradmin">machcoordinatoradmin</a>
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-tools-machdeployeradmin" href="/en//tools/machdeployeradmin">machdeployeradmin</a>
                        
                      </li>
                    </ul>
                  
                  
                
                  
                  
                  <li class="td-sidebar-nav__section-title">
                    <a href="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section ">FAQ</a>
                  </li>
                  
                  
                    <ul>
                      <li class="collapse show" id="faq">
                        
                          <a class="td-sidebar-link td-sidebar-link__page " id="m-machbase-manual-faq-how-to-fix-properties-when-an-insufficient-memory-error-occurs" href="/en//faq/memory-error">How to fix properties when an insufficient memory error occurs</a>
                        
                      </li>
                    </ul>
                  
                  
                
              </ul>
            </li>
          </ul>
        
        
      </ul>
    
  </nav>
</div>

          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
              <div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
              </div>
              <nav id="TableOfContents"><ul>
              <li><ul id="TOC">
                <!-- Links will be appended here-->
              </ul></li>
              </ul></nav>
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	      <ol class="breadcrumb spb-1">
              
              
                
                  
                    
                      
                      <li class="breadcrumb-item">
                        <a href="/en/sdk/">Sdk</a>
                      </li>
                      
                    
                  
                
              
                
                  
                    <li class="breadcrumb-item active" aria-current="page">
                      <a href="/en/sdk/dotnet.html">.NET Connector</a>
                    </li>
                  
                
              
	      </ol>
           </nav>
           <div class="td-content">        
            
              
            
            
	      <!-- Copyright 2019-2021 Vanessa Sochat-->
<h1 style="margin-bottom:0px">.NET Connector</h1>

<span class="post-date" style="font-style: italic;"></span>
<h1 id="index">Index</h1>

<ul>
  <li><a href="#class">Class</a>
    <ul>
      <li><a href="#machconnection--dbconnection">MachConnection : DbConnection</a></li>
      <li><a href="#machcommand--dbcommand">MachCommand : DbCommand</a></li>
      <li><a href="#machdatareader--dbdatareader">MachDataReader : DbDataReader</a></li>
      <li><a href="#machparametercollection--dbparametercollection">MachParameterCollection : DbParameterCollection</a></li>
      <li><a href="#machparameter--dbparameter">MachParameter : DbParameter</a></li>
      <li><a href="#machexception--dbexception">MachException : DbException</a></li>
      <li><a href="#machappendwriter">MachAppendWriter</a></li>
      <li><a href="#errordelegatefunctype">ErrorDelegateFuncType</a></li>
      <li><a href="#machappendexception--machexception">MachAppendException : MachException</a></li>
      <li><a href="#machtransaction">MachTransaction</a></li>
    </ul>
  </li>
  <li><a href="#sample-code">Sample Code</a>
    <ul>
      <li><a href="#connection">Connection</a></li>
      <li><a href="#executing-queries">Executing Queries</a></li>
      <li><a href="#executing-select">Executing SELECT</a></li>
      <li><a href="#parameter-binding">Parameter Binding</a></li>
      <li><a href="#append">APPEND</a></li>
    </ul>
  </li>
</ul>

<p>The .NET (C #) Connector library that supports some features of the ADO.NET driver is provided.</p>

<p>The library location is  $MACHBASE_HOME/lib/ provided as a DLL type. It provides different DLLs depending on the .NET version.</p>

<ul>
  <li>.NET Framework 4.0: machNetConnector.dll</li>
  <li>.NET Core 2.0: machNetConnectorCore.dll</li>
</ul>

<h1 id="class">Class</h1>

<blockquote>
  <p><img src="/icons/tips.png" alt="tips" />  Features not listed below may not be implemented yet or may not work correctly.<br />
      If you call a method or field that is not a named instance, it generates NotImplementedException or a NotSupportedException.</p>
</blockquote>

<h2 id="machconnection--dbconnection">MachConnection : DbConnection</h2>

<p>This class is responsible for linking with Machbase. Because it inherits IDisposable like DbConnection, it supports disassociation through Dispose () or automatic disposition of object using using () statement.</p>

<table>
  <thead>
    <tr>
      <th>Constructor</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MachConnection(string aConnectionString)</td>
      <td>Creates a MachConnection with a Connection String as input.</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Open()</td>
      <td>Attempts to connect to the connection string.</td>
    </tr>
    <tr>
      <td>Close()</td>
      <td>Closes the connection when connecting.</td>
    </tr>
    <tr>
      <td>BeginDbTransaction(IsolationLevel isolationLevel)</td>
      <td><span style="color: #4f0111;">(Not yet implemented) MACHBASE does not support this object because there is no special transaction.</span></td>
    </tr>
    <tr>
      <td>CreateDbCommand()</td>
      <td><span style="color: #4f0111;">(Not yet implemented) Explicitly induces MachCommands to be created</span></td>
    </tr>
    <tr>
      <td>ChangeDatabase(string databaseName)</td>
      <td><span style="color: #4f0111;">(Not yet implemented) MACHBASE has no DATABASE classification.</span></td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>State</td>
      <td>Represents a System.Data.ConnectionState value.</td>
    </tr>
    <tr>
      <td>StatusString</td>
      <td>Indicates the state to be performed by the connected MachCommand.<br /><br />This is used internally to decorate the Error Message and it is not appropriate to check the status of the query with this value because it indicates the state in which the operation started.</td>
    </tr>
    <tr>
      <td>Database</td>
      <td><span style="color: #4f0111;">(Not yet implemented)<span></span></span></td>
    </tr>
    <tr>
      <td>DataSource</td>
      <td><span style="color: #4f0111;">(Not yet implemented)<span></span></span></td>
    </tr>
    <tr>
      <td>ServerVersion</td>
      <td><span style="color: #4f0111;">(Not yet implemented)<span></span></span></td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><img src="/icons/tips.png" alt="tips" />   <strong>Connection String</strong><br />
      Each item is separated by a semicolon (;). <br />
      Many of the keywords in the same section have the same meaning.<br /></p>
  <table>
 <thead>
   <tr>
     <th>Keyword</th>
     <th>Description</th>
     <th>Example</th>
     <th>Default value</th>
   </tr>
 </thead>
 <tbody>
   <tr>
     <td>DSN<br />SERVER<br />HOST</td>
     <td>Hostname</td>
     <td>DSN=localhost<br />SERVER=192.168.0.1</td>
     <td></td>
   </tr>
   <tr>
     <td>PORT<br />PORT_NO</td>
     <td>Port No.</td>
     <td>PORT=5656</td>
     <td>5656</td>
   </tr>
   <tr>
     <td>USERID<br />USERNAME<br />USER<br />UID</td>
     <td>User ID</td>
     <td>USER=SYS</td>
     <td>SYS</td>
   </tr>
   <tr>
     <td>PASSWORD<br />PWD</td>
     <td>User password</td>
     <td>PWD=manager</td>
     <td></td>
   </tr>
   <tr>
     <td>CONNECT_TIMEOUT<br />ConnectionTimeout<br />connectTimeout</td>
     <td>Maximum connection time</td>
     <td>CONNECT_TIMEOUT</td>
     <td>60 second</td>
   </tr>
   <tr>
     <td>COMMAND_TIMEOUT<br />commandTimeout</td>
     <td>Maximum time to perform each command</td>
     <td>COMMAND_TIMEOUT</td>
     <td>60 second</td>
   </tr>
 </tbody>
</table>
  <p>      As an example, we can prepare the following string.<br />
      <code class="language-plaintext highlighter-rouge">String sConnString = String.Format("DSN={0};PORT_NO={1};UID=;PWD=MANAGER;CONNECT_TIMEOUT=10000;COMMAND_TIMEOUT=50000", SERVER_HOST, SERVER_PORT);</code></p>
</blockquote>

<h2 id="machcommand--dbcommand">MachCommand : DbCommand</h2>

<p>A class that performs <strong>SQL commands or APPEND</strong> using MachConnection. 
Since it inherits IDisposable like DbCommand, it supports object disposal through Dispose () or automatic disposal of object using using () statement</p>

<table>
  <thead>
    <tr>
      <th>Constructor</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MachCommand(string aQueryString, MachConnection)</td>
      <td>Creates by typing the query to be executed along with the MachConnection object to be connected.</td>
    </tr>
    <tr>
      <td>MachCommand(MachConnection)</td>
      <td>Creates a MachConnection object to connect to. Use only if there is no query to perform (eg APPEND).</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>void CreateParameter() /<br />void CreateDbParameter()</td>
      <td>Creates a new MachParameter.</td>
    </tr>
    <tr>
      <td>void Cancel()</td>
      <td><span style="color: #4f0111;">(Not yet implemented)</span></td>
    </tr>
    <tr>
      <td>void Prepare()</td>
      <td><span style="color: #4f0111;">(Not yet implemented)</span></td>
    </tr>
    <tr>
      <td>MachAppendWriter<br />AppendOpen(aTableName, aErrorCheckCount = 0, MachAppendOption = None)</td>
      <td>
        Starts APPEND. Returns a MachAppendWriter object.<br /><br />
        - aTableName: Target table name<br />
        - aErrorCheckCount: Each time the cumulative number of records entered by APPEND-DATA matches, it is checked whether it is sent to the server or not.<br />
          In other words, you are setting the automatic APPEND-FLUSH point.<br />
        - MachAppendOption: Currently only one option is provided.<br />
          - MachAppendOption.None: No options are attached.<br />
          - MachAppendOption.MicroSecTruncated: When inputting the value of a DateTime object, enter the value expressed only up to microsecond.<br />
          (The Ticks value of a DateTime object is expressed up to 100 nanoseconds.)
      </td>
    </tr>
    <tr>
      <td>void<br />AppendData(MachAppendWriter aWriter, List&lt;object&gt; aDataList)</td>
      <td>
        Through the MachAppendWriter object, it takes a list containing the data and enters it into the database.<br />
        - In the order of the data in the List, each datatype must match the datatype of the column represented in the table.<br />
        - If the data in the List is insufficient or overflows, an error occurs.<br /><br />
        <blockquote> 
          <p><img src="/icons/warnings.png" alt="warnings" /> &nbsp;When representing a time value with a ulong object, simply do not enter the Tick value of the DateTime object. <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In that value, you must enter a <u>value that excludes the DateTime Tick value that represents 1970-01-01</u>.</p>
        </blockquote>
      </td>
    </tr>
    <tr>
      <td>void<br />AppendDataWithTime(MachAppendWriter aWriter, List&lt;object&gt; aDataList, DateTime aArrivalTime)</td>
      <td>Method that explicitly puts an _arrival_time value into a DateTime object in AppendData().</td>
    </tr>
    <tr>
      <td>void<br />AppendDataWithTime(MachAppendWriter aWriter, List&lt;object&gt; aDataList, ulong aArrivalTimeLong)</td>
      <td>Method that can explicitly put _arrival_time value into a ulong object in AppendData().<br /><br />Refer to AppendData() above for problems that may occur when typing a ulong value as an _arrival_time value.</td>
    </tr>
    <tr>
      <td>void AppendFlush(MachAppendWriter aWriter)</td>
      <td>
        The data entered by AppendData() is immediately sent to the server to force data insert.<br /><br />
        The more frequently the call is made, the lower the data loss rate due to the system error and the faster the error check, although the performance is lowered.<br />
        The less frequently the call is made, the more likely the data loss will occur and the error checking will be delayed, but the performance will increase significantly.
      </td>
    </tr>
    <tr>
      <td>void AppendClose(MachAppendWriter aWriter)</td>
      <td>Closes APPEND. Internally, after calling AppendFlush(), the actual protocol is internally finished.</td>
    </tr>
    <tr>
      <td>int ExecuteNonQuery()</td>
      <td>Performs the input query. Returns the number of records affected by the query.<br /><br />
        It is usually used when performing queries except SELECT.
      </td>
    </tr>
    <tr>
      <td>object ExecuteScalar()</td>
      <td>Performs the input query. Returns the first value of the query targetlist as an object.<br /><br />
        It is usually used when you want to perform a SELECT query, especially a SELECT (Scalar Query) with only one result, and get the result without a DbDataReader.
      </td>
    </tr>
    <tr>
      <td>DbDataReader ExecuteDbDataReader(CommandBehavior aBehavior)</td>
      <td>Executes the input query, generates a DbDataReader that can read the result of the query, and returns it.</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Connection / DbConnection</td>
      <td>Connected MachConnection.</td>
    </tr>
    <tr>
      <td>ParameterCollection / DbParameterCollection</td>
      <td>The MachParameterCollection to use for the Binding purpose.</td>
    </tr>
    <tr>
      <td>CommandText</td>
      <td>Query string.</td>
    </tr>
    <tr>
      <td>CommandTimeout</td>
      <td>The amount of time it takes to perform a particular task, waiting for a response from the server.<br />It follows the values ​​set in MachConnection, where you can only reference values.</td>
    </tr>
    <tr>
      <td>FetchSize</td>
      <td>The number of records to fetch from the server at one time . The default value is 3000.</td>
    </tr>
    <tr>
      <td>IsAppendOpened</td>
      <td>Determines if Append is already open when APPEND is at work</td>
    </tr>
    <tr>
      <td>CommandType</td>
      <td><span style="color: #4f0111;">(Not yet implemented)</span></td>
    </tr>
    <tr>
      <td>DesignTimeVisible</td>
      <td><span style="color: #4f0111;">(Not yet implemented)</span></td>
    </tr>
    <tr>
      <td>UpdatedRowSource</td>
      <td><span style="color: #4f0111;">(Not yet implemented)</span></td>
    </tr>
  </tbody>
</table>

<h2 id="machdatareader--dbdatareader">MachDataReader : DbDataReader</h2>

<p>This is a class that reads fetch results. Only objects created with MachCommand.ExecuteDbDataReader () that can not be explicitly created are available.</p>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>string GetName(int ordinal)</td>
      <td>Returns the ordinal column name.</td>
    </tr>
    <tr>
      <td>string GetDataTypeName(int ordinal)</td>
      <td>Returns the datatype name of the ordinal column.</td>
    </tr>
    <tr>
      <td>Type GetFieldType(int ordinal)</td>
      <td>Returns the datatype of the ordinal column.</td>
    </tr>
    <tr>
      <td>int GetOrdinal(string name)</td>
      <td>Returns the index at which the column name is located.</td>
    </tr>
    <tr>
      <td>object GetValue(int ordinal)</td>
      <td>Returns the ordinal value of the current record.</td>
    </tr>
    <tr>
      <td>bool IsDBNull(int ordinal)</td>
      <td>Returns whether the ordinal value of the current record is NULL.</td>
    </tr>
    <tr>
      <td>int GetValues(object[] values)</td>
      <td>Sets all the values ​​of the current record and returns the number.</td>
    </tr>
    <tr>
      <td>xxxx GetXXXX(int ordinal)</td>
      <td>Returns the ordinal column value according to the datatype (XXXX).<br /> - Boolean<br /> - Byte<br /> - Char<br /> - Int16 / 32/64<br /> - DateTime<br /> - String<br /> - Decimal<br /> - Double<br /> - Float</td>
    </tr>
    <tr>
      <td>bool Read()</td>
      <td>Reads the next record. Returns False if the result does not exist.</td>
    </tr>
    <tr>
      <td>DataTable GetSchemaTable()</td>
      <td><span style="color: #4f0111;">(Not supported)</span></td>
    </tr>
    <tr>
      <td>bool NextResult()</td>
      <td><span style="color: #4f0111;">(Not supported)</span></td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>FetchSize</td>
      <td>The number of records to fetch from the server at one time. The default is 3000, which can not be modified here.</td>
    </tr>
    <tr>
      <td>FieldCount</td>
      <td>Number of result columns.</td>
    </tr>
    <tr>
      <td>this[int ordinal]</td>
      <td>Equivalent to object GetValue (int ordinal).</td>
    </tr>
    <tr>
      <td>this[string name]</td>
      <td>Equivalent to object GetValue(GetOrdinal(name).</td>
    </tr>
    <tr>
      <td>HasRows</td>
      <td>Indicates whether the result is present.</td>
    </tr>
    <tr>
      <td>RecordsAffected</td>
      <td>Unlike MachCommand, here, it represents Fetch Count.</td>
    </tr>
  </tbody>
</table>

<h2 id="machparametercollection--dbparametercollection">MachParameterCollection : DbParameterCollection</h2>

<p>This is a class that binds parameters needed by MachCommand.</p>

<p>If you do this after binding, the values ​​are done together.</p>

<blockquote>
  <p><img src="/icons/tips.png" alt="tips" />  Since the concept of Prepared Statement is not implemented, execution performance after Binding is the same as the performance performed first.</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MachParameter<br />Add(string parameterName, DbType dbType)</td>
      <td>Adds the MachParameter, specifying the parameter name and type. <br /><br />Returns the added MachParameter object.</td>
    </tr>
    <tr>
      <td>int Add(object value)</td>
      <td>Adds a value. Returns the index added.</td>
    </tr>
    <tr>
      <td>void AddRange(Array values)</td>
      <td>Adds an array of simple values.</td>
    </tr>
    <tr>
      <td>MachParameter<br />AddWithValue(string parameterName, object value)</td>
      <td>Adds the parameter name and its value. <br /><br />Returns the added MachParameter object.</td>
    </tr>
    <tr>
      <td>bool Contains(object value)</td>
      <td>Determines whether or not the corresponding value is added.</td>
    </tr>
    <tr>
      <td>bool Contains(string value)</td>
      <td>Determines whether or not the corresponding parameter name is added.</td>
    </tr>
    <tr>
      <td>void Clear()</td>
      <td>Deletes all parameters.</td>
    </tr>
    <tr>
      <td>int IndexOf(object value)</td>
      <td>Returns the index of the corresponding value.</td>
    </tr>
    <tr>
      <td>int IndexOf(string parameterName)</td>
      <td>Returns the index of the corresponding parameter name.</td>
    </tr>
    <tr>
      <td>void Insert(int index, object value)</td>
      <td>Adds the value to a specific index.</td>
    </tr>
    <tr>
      <td>void Remove(object value)</td>
      <td>Deletes the parameter including the value.</td>
    </tr>
    <tr>
      <td>void RemoveAt(int index)</td>
      <td>Deletes the parameter located at the index.</td>
    </tr>
    <tr>
      <td>void RemoveAt(string parameterName)</td>
      <td>Deletes the parameter with that name.</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Count</td>
      <td>Number of parameters</td>
    </tr>
    <tr>
      <td>this[int index]</td>
      <td>Indicates the MachParameter at index.</td>
    </tr>
    <tr>
      <td>this[string name]</td>
      <td>Indicates the MachParameter of the order in which the parameter names match.</td>
    </tr>
  </tbody>
</table>

<h2 id="machparameter--dbparameter">MachParameter : DbParameter</h2>

<p>This is a class that contains the information that binds the necessary parameters to each MachCommand.</p>

<p>No special methods are supported.</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ParameterName</td>
      <td>Parameter name</td>
    </tr>
    <tr>
      <td>Value</td>
      <td>Value</td>
    </tr>
    <tr>
      <td>Size</td>
      <td>Value size</td>
    </tr>
    <tr>
      <td>Direction</td>
      <td>ParameterDirection (Input / Output / InputOutput / ReturnValue)<br /><br />The default value is Input.</td>
    </tr>
    <tr>
      <td>DbType</td>
      <td>DB Type</td>
    </tr>
    <tr>
      <td>MachDbType</td>
      <td>MACHBASE DB Type<br /><br />May differ from DB Type.</td>
    </tr>
    <tr>
      <td>IsNullable</td>
      <td>Whether nullable</td>
    </tr>
    <tr>
      <td>HasSetDbType</td>
      <td>Whether DB Type is specified</td>
    </tr>
  </tbody>
</table>

<h2 id="machexception--dbexception">MachException : DbException</h2>

<p>This is a class that displays errors that appear in Machbase.</p>

<p>An error message is set, and all error messages  can be found in  MachErrorMsg .</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>int MachErrorCode</td>
      <td>Error code provided by MACHBASE</td>
    </tr>
  </tbody>
</table>

<h2 id="machappendwriter">MachAppendWriter</h2>

<p>APPEND is supported as a separate class using MachCommand.</p>

<p>This is a class to support MACHBASE Append Protocol, not ADO.NET standard.
It is created with MachCommand’s AppendOpen () without a separate constructor.</p>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>void SetErrorDelegator(ErrorDelegateFuncType aFunc)</td>
      <td>Specifies the ErrorDelegateFunc to call when an error occurs.</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SuccessCount</td>
      <td>Number of successful records. Is set after AppendClose().</td>
    </tr>
    <tr>
      <td>FailureCount</td>
      <td>The number of records that failed input. Set after AppendClose ().</td>
    </tr>
    <tr>
      <td>Option</td>
      <td>MachAppendOption received input during AppendOpen()</td>
    </tr>
  </tbody>
</table>

<h2 id="errordelegatefunctype">ErrorDelegateFuncType</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">public</span> <span class="n">delegate</span> <span class="kt">void</span> <span class="nf">ErrorDelegateFuncType</span><span class="p">(</span><span class="n">MachAppendException</span> <span class="n">e</span><span class="p">);</span>
</code></pre></div></div>

<p>In MachAppendWriter, you can specify a function to detect errors occurring on the MACHBASE server side during APPEND.</p>

<p>In .NET, this function type is specified as a Delegator Function.</p>

<h2 id="machappendexception--machexception">MachAppendException : MachException</h2>

<p>Same as MachException, except that:</p>

<ul>
  <li>An error message is received from the server side.</li>
  <li>A data buffer in which an error has occurred can be obtained. (comma-separated) can be used to process and re-append or record data.</li>
</ul>

<p>The exception is only available within the ErrorDelegateFunc.</p>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GetRowBuffer()</td>
      <td>A data buffer in which an error has occurred can be obtained.</td>
    </tr>
  </tbody>
</table>

<h2 id="machtransaction">MachTransaction</h2>

<p>Not supported.</p>

<h1 id="sample-code">Sample Code</h1>

<h2 id="connection">Connection</h2>

<p>You can create a MachConnection and use Open () - Close ().</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">String</span> <span class="n">sConnString</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"DSN={0};PORT_NO={1};UID=;PWD=MANAGER;"</span><span class="p">,</span> <span class="n">SERVER_HOST</span><span class="p">,</span> <span class="n">SERVER_PORT</span><span class="p">);</span>
<span class="n">MachConnection</span> <span class="n">sConn</span> <span class="o">=</span> <span class="n">new</span> <span class="nf">MachConnection</span><span class="p">(</span><span class="n">sConnString</span><span class="p">);</span>
<span class="n">sConn</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
<span class="c1">//... do something</span>
<span class="n">sConn</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
</code></pre></div></div>

<p>If you use the using statement, you do not need to call Close (), which is a connection closing task.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">String</span> <span class="n">sConnString</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"DSN={0};PORT_NO={1};UID=;PWD=MANAGER;"</span><span class="p">,</span> <span class="n">SERVER_HOST</span><span class="p">,</span> <span class="n">SERVER_PORT</span><span class="p">);</span>
<span class="n">using</span> <span class="p">(</span><span class="n">MachConnection</span> <span class="n">sConn</span> <span class="o">=</span> <span class="n">new</span> <span class="nf">MachConnection</span><span class="p">(</span><span class="n">sConnString</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">sConn</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
    <span class="c1">//... do something</span>
<span class="p">}</span> <span class="c1">// you don't need to call sConn.Close();</span>
</code></pre></div></div>

<h2 id="executing-queries">Executing Queries</h2>

<p>Create a MachCommand and perform the query.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">String</span> <span class="n">sConnString</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"DSN={0};PORT_NO={1};UID=;PWD=MANAGER;"</span><span class="p">,</span> <span class="n">SERVER_HOST</span><span class="p">,</span> <span class="n">SERVER_PORT</span><span class="p">);</span>
<span class="n">using</span> <span class="p">(</span><span class="n">MachConnection</span> <span class="n">sConn</span> <span class="o">=</span> <span class="n">new</span> <span class="nf">MachConnection</span><span class="p">(</span><span class="n">sConnString</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">String</span> <span class="n">sQueryString</span> <span class="o">=</span> <span class="s">"CREATE TABLE tab1 ( col1 INTEGER, col2 VARCHAR(20) )"</span><span class="p">;</span>
    <span class="n">MachCommand</span> <span class="n">sCommand</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MachCommand</span><span class="p">(</span><span class="n">sQueryString</span> <span class="p">,</span> <span class="n">sConn</span><span class="p">)</span>
    <span class="n">try</span>
    <span class="p">{</span>
        <span class="n">sCommand</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="n">catch</span> <span class="p">(</span><span class="n">MachException</span> <span class="n">me</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">throw</span> <span class="n">me</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Again, using the using statement, MachCommand release can be done immediately.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">String</span> <span class="n">sConnString</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"DSN={0};PORT_NO={1};UID=;PWD=MANAGER;"</span><span class="p">,</span> <span class="n">SERVER_HOST</span><span class="p">,</span> <span class="n">SERVER_PORT</span><span class="p">);</span>
<span class="n">using</span> <span class="p">(</span><span class="n">MachConnection</span> <span class="n">sConn</span> <span class="o">=</span> <span class="n">new</span> <span class="nf">MachConnection</span><span class="p">(</span><span class="n">sConnString</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">String</span> <span class="n">sQueryString</span> <span class="o">=</span> <span class="s">"CREATE TABLE tab1 ( col1 INTEGER, col2 VARCHAR(20) )"</span><span class="p">;</span>
    <span class="n">using</span><span class="p">(</span><span class="n">MachCommand</span> <span class="n">sCommand</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MachCommand</span><span class="p">(</span><span class="n">sQueryString</span> <span class="p">,</span> <span class="n">sConn</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">try</span>
        <span class="p">{</span>
            <span class="n">sCommand</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="n">catch</span> <span class="p">(</span><span class="n">MachException</span> <span class="n">me</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">throw</span> <span class="n">me</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="executing-select">Executing SELECT</h2>

<p>You can get a MachDataReader by executing a MachCommand with a SELECT query.</p>

<p>You can fetch the records one by one through the MachDataReader.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">String</span> <span class="n">sConnString</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"DSN={0};PORT_NO={1};UID=;PWD=MANAGER;"</span><span class="p">,</span> <span class="n">SERVER_HOST</span><span class="p">,</span> <span class="n">SERVER_PORT</span><span class="p">);</span>
<span class="n">using</span> <span class="p">(</span><span class="n">MachConnection</span> <span class="n">sConn</span> <span class="o">=</span> <span class="n">new</span> <span class="nf">MachConnection</span><span class="p">(</span><span class="n">sConnString</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">String</span> <span class="n">sQueryString</span> <span class="o">=</span> <span class="s">"SELECT * FROM tab1;"</span><span class="p">;</span>
    <span class="n">using</span><span class="p">(</span><span class="n">MachCommand</span> <span class="n">sCommand</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MachCommand</span><span class="p">(</span><span class="n">sQueryString</span> <span class="p">,</span> <span class="n">sConn</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">try</span>
        <span class="p">{</span>
            <span class="n">MachDataReader</span> <span class="n">sDataReader</span> <span class="o">=</span> <span class="n">sCommand</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">();</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">sDataReader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">sDataReader</span><span class="p">.</span><span class="n">FieldCount</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"{0} : {1}"</span><span class="p">,</span>
                                                    <span class="n">sDataReader</span><span class="p">.</span><span class="n">GetName</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                                                    <span class="n">sDataReader</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="n">i</span><span class="p">)));</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">catch</span> <span class="p">(</span><span class="n">MachException</span> <span class="n">me</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">throw</span> <span class="n">me</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="parameter-binding">Parameter Binding</h2>

<p>You can create a MachParameterCollection and then link it to a MachCommand.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">String</span> <span class="n">sConnString</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"DSN={0};PORT_NO={1};UID=;PWD=MANAGER;"</span><span class="p">,</span> <span class="n">SERVER_HOST</span><span class="p">,</span> <span class="n">SERVER_PORT</span><span class="p">);</span>
<span class="n">using</span> <span class="p">(</span><span class="n">MachConnection</span> <span class="n">sConn</span> <span class="o">=</span> <span class="n">new</span> <span class="nf">MachConnection</span><span class="p">(</span><span class="n">sConnString</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">string</span> <span class="n">sSelectQuery</span> <span class="o">=</span> <span class="err">@</span><span class="s">"SELECT *</span><span class="err">
</span><span class="s">        FROM tab2</span><span class="err">
</span><span class="s">        WHERE CreatedDateTime &lt; @CurrentTime</span><span class="err">
</span><span class="s">        AND CreatedDateTime &gt;= @PastTime"</span><span class="p">;</span>
 
    <span class="n">using</span> <span class="p">(</span><span class="n">MachCommand</span> <span class="n">sCommand</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MachCommand</span><span class="p">(</span><span class="n">sSelectQuery</span><span class="p">,</span> <span class="n">sConn</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">DateTime</span> <span class="n">sCurrtime</span> <span class="o">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">;</span>
        <span class="n">DateTime</span> <span class="n">sPastTime</span> <span class="o">=</span> <span class="n">sCurrtime</span><span class="p">.</span><span class="n">AddMinutes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
 
        <span class="n">try</span>
        <span class="p">{</span>
            <span class="n">sCommand</span><span class="p">.</span><span class="n">ParameterCollection</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">new</span> <span class="n">MachParameter</span> <span class="p">{</span> <span class="n">ParameterName</span> <span class="o">=</span> <span class="s">"@CurrentTime"</span><span class="p">,</span> <span class="n">Value</span> <span class="o">=</span> <span class="n">sCurrtime</span> <span class="p">});</span>
            <span class="n">sCommand</span><span class="p">.</span><span class="n">ParameterCollection</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">new</span> <span class="n">MachParameter</span> <span class="p">{</span> <span class="n">ParameterName</span> <span class="o">=</span> <span class="s">"@PastTime"</span><span class="p">,</span> <span class="n">Value</span> <span class="o">=</span> <span class="n">sPastTime</span> <span class="p">});</span>
 
            <span class="n">MachDataReader</span> <span class="n">sDataReader</span> <span class="o">=</span> <span class="n">sCommand</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">();</span>
 
            <span class="k">while</span> <span class="p">(</span><span class="n">sDataReader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">sDataReader</span><span class="p">.</span><span class="n">FieldCount</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"{0} : {1}"</span><span class="p">,</span>
                                                    <span class="n">sDataReader</span><span class="p">.</span><span class="n">GetName</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                                                    <span class="n">sDataReader</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="n">i</span><span class="p">)));</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">catch</span> <span class="p">(</span><span class="n">MachException</span> <span class="n">me</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">throw</span> <span class="n">me</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="append">APPEND</h2>

<p>When you run AppendOpen () on a MachCommand, you get a MachAppendWriter object.</p>

<p>Using this object and MachCommand, you can get a list of one input record and perform an AppendData ().
AppendFlush () will reflect the input of all records, and AppendClose () will end the entire Append process.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">String</span> <span class="n">sConnString</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"DSN={0};PORT_NO={1};UID=;PWD=MANAGER;"</span><span class="p">,</span> <span class="n">SERVER_HOST</span><span class="p">,</span> <span class="n">SERVER_PORT</span><span class="p">);</span>
<span class="n">using</span> <span class="p">(</span><span class="n">MachConnection</span> <span class="n">sConn</span> <span class="o">=</span> <span class="n">new</span> <span class="nf">MachConnection</span><span class="p">(</span><span class="n">sConnString</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">using</span> <span class="p">(</span><span class="n">MachCommand</span> <span class="n">sAppendCommand</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MachCommand</span><span class="p">(</span><span class="n">sConn</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">MachAppendWriter</span> <span class="n">sWriter</span> <span class="o">=</span> <span class="n">sAppendCommand</span><span class="p">.</span><span class="n">AppendOpen</span><span class="p">(</span><span class="s">"tab2"</span><span class="p">);</span>
        <span class="n">sWriter</span><span class="p">.</span><span class="n">SetErrorDelegator</span><span class="p">(</span><span class="n">AppendErrorDelegator</span><span class="p">);</span>
 
        <span class="n">var</span> <span class="n">sList</span> <span class="o">=</span> <span class="n">new</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">object</span><span class="o">&gt;</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">100000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">sList</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">sList</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"NAME_{0}"</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span><span class="p">));</span>
 
            <span class="n">sAppendCommand</span><span class="p">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">sWriter</span><span class="p">,</span> <span class="n">sList</span><span class="p">);</span>
 
            <span class="n">sList</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
 
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">sAppendCommand</span><span class="p">.</span><span class="n">AppendFlush</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
 
        <span class="n">sAppendCommand</span><span class="p">.</span><span class="n">AppendClose</span><span class="p">(</span><span class="n">sWriter</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"Success Count : {0}"</span><span class="p">,</span> <span class="n">sWriter</span><span class="p">.</span><span class="n">SuccessCount</span><span class="p">));</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"Failure Count : {0}"</span><span class="p">,</span> <span class="n">sWriter</span><span class="p">.</span><span class="n">FailureCount</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">private</span> <span class="k">static</span> <span class="kt">void</span> <span class="nf">AppendErrorDelegator</span><span class="p">(</span><span class="n">MachAppendException</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"{0}"</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"{0}"</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">GetRowBuffer</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div></div>


<script
  src="/en/assets/js/jquery-3.3.1/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8= sha256-T+aPohYXbm0fRYDpJLr+zJ9RmYTswGsahAoIsNiMld4="
  crossorigin="anonymous"></script>

<script>
$(document).ready(function() {

    var toc = $('#TOC');

    // Select each header
    sections = $('.td-content h1');
        $.each(sections, function(idx, v) {
            section = $(v);
            var div_id = $(section).attr('id');
            var div_text = section.text().split('¶')[0];
            var parent = $("#" + div_id)
            var content = '<li id="link_' + div_id + '" class="md-nav__item"><a class="md-nav__link" href="#' + div_id + '" title="' + div_text +'">' + div_text +'</a></li>';
            $(toc).append(content);

            // Add section code to subnavigation
            var children = $('<nav class="md-nav"><ul class="md-nav__list"></nav></ul>')
            var contenders = $("#" + div_id).nextUntil("h1");
            $.each(contenders, function(idx, contender){
               if($(contender).is('h2') || $(contender).is('h3')) {
                   var contender_id = $(contender).attr('id');
                   var contender_text = $(contender).text().split('¶')[0];
                   var content = '<li class="md-nav__item"><a class="md-nav__link" href="#' + contender_id + '" title="' + contender_text +'">' + contender_text +'</a></li>';
                   children.append(content);
                }
             })
             $("#link_" + div_id).append(children);
        });
    });
</script>

<script>
var headers = ["h1", "h2", "h3", "h4"]
var colors = ["red", "orange", "green", "blue"]

$.each(headers, function(i, header){
    var color = colors[i];
    $(header).each(function () {
        var href=$(this).attr("id");
        $(this).append('<a class="headerlink" style="color:' + color + '" href="#' + href + '" title="Permanent link">¶</a>')
    });
})
</script>



	
              
              <!-- <style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<h5 class="feedback--title">Feedback</h5>
<p class="feedback--question">Was this page helpful?</p>
<button class="feedback--answer feedback--answer-yes">Yes</button>
<button class="feedback--answer feedback--answer-no">No</button>
<p class="feedback--response feedback--response-yes">
  Glad to hear it! Please <a href="https://github.com/machbase/dbms-manual/issues/new">tell us how we can improve</a>.
</p>
<p class="feedback--response feedback--response-no">
  Sorry to hear that. Please <a href="https://github.com/machbase/dbms-manual/issues/new">tell us how we can improve</a>.
</p>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof ga !== 'function') return;
    const args = {
      command: 'send',
      hitType: 'event',
      category: 'Helpful',
      action: 'click',
      label: window.location.pathname,
      value: value
    };
    ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(1);
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script><br/>

 -->
           </div>
          </main>
        </div>
      </div>
      <footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        <ul class="list-inline mb-0">  
          
            <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="" aria-label="Twitter" data-original-title="Twitter">
              <a class="text-white" target="_blank" href="https://twitter.com/machbase">
                <i class="fab fa-twitter"></i>
              </a>
            </li>
          
          
        </ul>
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        <ul class="list-inline mb-0">  
          <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="" aria-label="GitHub" data-original-title="GitHub">
            <a class="text-white" target="_blank" href="https://github.com/machbase/dbms-manual">
              <i class="fab fa-github"></i>
            </a>
          </li>
        </ul>
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">© 2023  All Rights Reserved</small>
        
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script src="/en/assets/js/main.js"></script>

  </body>
</html>